<assembly
	xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3 http://maven.apache.org/xsd/assembly-1.1.3.xsd">
	<id>enterprise-${project.version}-${buildNumber}</id>
	<formats>
	<!-- 
		<format>tar.gz</format>
		 -->
		<format>zip</format>
	</formats>
	<files>
		<file>
			<source>${project.build.directory}/${finalName}.jar</source>
			<outputDirectory></outputDirectory>
			<destName>ant-media-server.jar</destName>
		</file>
	</files>
	<fileSets>
		<fileSet>
			<directory>${project.basedir}</directory>
			<outputDirectory></outputDirectory>
			<includes>
				<include>license.txt</include>
			</includes>
		</fileSet>
		<fileSet>
			<directory>${project.build.directory}/ant-media-server-service-${project.parent.version}</directory>
			<outputDirectory></outputDirectory>
		</fileSet>
		<fileSet>
			<directory>${project.build.directory}/lib</directory>
			<outputDirectory>lib</outputDirectory>
			<includes>
				<include>*.jar</include>
			</includes>
			<excludes>
				<exclude>ecj-*.jar</exclude>
				<exclude>tomcat-*.jar</exclude>
				<exclude>tomcatplugin-*.jar</exclude>
				<exclude>websocket-*.jar</exclude>
				<exclude>antlr-2.7.7.jar</exclude>
				<exclude>asm-analysis-4.0.jar</exclude>
				<exclude>asm-commons-4.0.jar</exclude>
				<exclude>asm-tree-4.0.jar</exclude>
				<exclude>asm-util-4.0.jar</exclude>
				<exclude>commons-daemon-*.jar</exclude>
				<exclude>commons-logging-*.jar</exclude>
				<exclude>hamcrest-core-*.jar</exclude>
				<exclude>servlet-api-*.jar</exclude>
				<exclude>junit-${junit.version}.jar</exclude>
				<exclude>logback-access-*.jar</exclude>
				<exclude>ant-media-server-service-${project.parent.version}.jar</exclude>
				<exclude>red5-server-${red5-service.version}.jar</exclude>
				<exclude>red5-server-common-*.jar</exclude>
				<exclude>red5-server-1*.jar</exclude>
				<exclude>red5-service-*.jar</exclude>
				<exclude>ffmpeg-*.jar</exclude>
				<exclude>javacpp-*.jar</exclude>
				<exclude>cuda-*.jar</exclude>
				<exclude>ant-media-enterprise*.jar</exclude>
			</excludes>
		</fileSet>
		<fileSet>
			<directory>${project.build.directory}/plugins</directory>
			<outputDirectory>plugins</outputDirectory>
			<includes>
				<include>*.jar</include>
			</includes>
			<excludes>
				<exclude>ant-media-server-*.jar</exclude>
				<exclude>red5-server-*.jar</exclude>
				<exclude>servlet-api-*.jar</exclude>
				<exclude>javassist-*.jar</exclude>
				<exclude>mina-*.jar</exclude>
				<exclude>ognl-*.jar</exclude>
				<exclude>sysout-over-*.jar</exclude>
				<exclude>spring-webmvc-*.jar</exclude>
				<exclude>tomcat-embed-logging-log4j-*.jar</exclude>
				<exclude>cors-filter-*.jar</exclude>
				<exclude>java-property-utils-*.jar</exclude>
				<exclude>red5-service-*.jar</exclude>
				<exclude>libtensorflow*.jar</exclude>
				<exclude>tensorflow*.jar</exclude>
				<exclude>commons-lang*.jar</exclude>
				<exclude>protobuf-java*.jar</exclude>
				
				<!-- Below libs are generic we need custom builds which are under src/main/server/plugins 
				and they will copied later in this file -->
				<exclude>ffmpeg*linux-x86.jar</exclude>
				<exclude>ffmpeg*linux-arm64.jar</exclude>
				<exclude>ffmpeg*linux-armhf.jar</exclude> 
				<exclude>ffmpeg*android*.jar</exclude>
				<exclude>ffmpeg*ppc64le.jar</exclude>
				<exclude>ffmpeg*windows*.jar</exclude>
				<exclude>javacpp*android*.jar</exclude>
				<exclude>javacpp*ios*.jar</exclude>
				<exclude>javacpp*linux-x86.jar</exclude>
				<exclude>javacpp*linux-arm64.jar</exclude>
				<exclude>javacpp*linux-armhf.jar</exclude>
				<exclude>javacpp*linux-ppc64le.jar</exclude>
				<exclude>javacpp*windows*.jar</exclude>	
				<exclude>cuda*ppc64le.jar</exclude>
				<exclude>cuda*macosx*.jar</exclude>
				<exclude>cuda*windows*.jar</exclude>
			</excludes>
		</fileSet>
		<fileSet>
			<directory>${project.basedir}/src/main/server</directory>
			<outputDirectory></outputDirectory>
			<includes>
				<include>*.bat</include>
			</includes>
		</fileSet>
		<fileSet>
			<directory>${project.basedir}/src/main/server</directory>
			<outputDirectory></outputDirectory>
			<fileMode>0755</fileMode>
			<includes>
				<include>*.sh</include>
			</includes>
			<filtered>true</filtered>
		</fileSet>
		<fileSet>
			<directory>${project.basedir}/src/main/server/conf</directory>
			<outputDirectory>conf</outputDirectory>
			<includes>
				<include>*.xml</include>
				<include>*.properties</include>
				<include>*.policy</include>
				<include>*.globals</include>
				<include>*.jmx</include>
				<include>*.json</include>
				<include>*.sh</include>
			</includes>
			<excludes>
				<exclude>build_standalone.properties</exclude>
			</excludes>
		</fileSet>
		
		<!--  Copy Custom Build Plugins  -->
		<!-- 
		<fileSet>
			<directory>${project.basedir}/src/main/server/plugins</directory>
			<outputDirectory>plugins</outputDirectory>
			<includes>
				<include>*.jar</include>
			</includes>
		</fileSet>
		 -->
		 
		<!-- NATIVE LIBRARIES -->
		<fileSet>
			<directory>${project.basedir}/src/main/server/lib/native</directory>
			<outputDirectory>lib/native</outputDirectory>
			<includes>
				<include>*</include>
			</includes>
		</fileSet>
		<fileSet>
			<directory>${project.basedir}/src/main/server/lib/detection</directory>
			<outputDirectory>lib/detection</outputDirectory>
			<includes>
				<include>*.pbtxt</include>
				<include>*.pb</include>
			</includes>
		</fileSet>
		<fileSet>
			<directory>${project.basedir}/src/main/server/webapps</directory>
			<outputDirectory>webapps</outputDirectory>
			<includes>
				<include>*.xml</include>
			</includes>
		</fileSet>
		
		<!-- ROOT -->
		<fileSet>
			<directory>${project.basedir}/src/main/server/webapps/root</directory>
			<outputDirectory>webapps/root</outputDirectory>
		</fileSet>
		<fileSet>
			<directory>${project.basedir}/src/main/server/webapps/root/WEB-INF</directory>
			<outputDirectory>webapps/root/WEB-INF</outputDirectory>
			<includes>
				<include>*.xml</include>
				<include>*.properties</include>
			</includes>
		</fileSet>
		
		<!-- Copy webapps  -->
		<fileSet>
			<directory>${project.build.directory}/webapps</directory>
			<outputDirectory>webapps</outputDirectory>
		</fileSet>
				<fileSet>
			<directory>${project.build.directory}</directory>
			<outputDirectory></outputDirectory>
			<includes>
				<include>*.war</include>
			</includes>
		</fileSet>

		<!-- Readme File-->
		<fileSet>
			<directory>${project.basedir}</directory>
			<outputDirectory></outputDirectory>
			<includes>
				<include>README.md</include>
			</includes>
		</fileSet>
	</fileSets>
</assembly>
